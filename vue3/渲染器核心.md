# 渲染器核心

### 面试题：介绍一下渲染器的核心原理

> 参考答案：
>
> 渲染器最核心的功能时处理虚拟 DOM 到真实 DOM 的渲染过程，这个过程包括几个阶段
>
> 1. 挂载：初次渲染时，将虚拟 DOM 转化为真实 DOM 并插入页面。他会根据虚拟节点树递归 DOM 元素并设置相关属性
> 2. 更新：当响应式数据发生变化时，会触发渲染函数重新执行，生成新的虚拟 DOM 树。然后通过 Patch 过程最小化更新真实 DOM
> 3. 卸载：当组件实例被销毁时，会触发卸载过程，将组件对应的真实 DOM 从页面中移除，并进行必要的清除工作
>
> 每一个步骤都有大量的细节需要考虑，就比如挂载，元素如何挂载就有很多细节点
>
> - 元素属性如何设置，使用 setAttribute 还是直接给 DOM 对象赋值方式完成设置
> - disabled 这样的特殊属性如何处理，因为 disabled 是一个布尔值
> - class 、style 的值类型有很多中，需要参数归一化
>
> 另外，渲染器和`响应式系统`是紧密结合在一起的，当组件首次渲染的时候，组件里面的响应式数据会和渲染函数建立依赖关系，当响应式数据发生变化后，会触发渲染函数重新执行，生成新的虚拟 DOM 树，根据新旧两个虚拟 DOM 树对比来最小化更新真实 DOM，这涉及到了 Vue 中的`diff`算法。diff 算法这里，Vue2 采用的是双端 diff，Vue3 则做了进一步优化，采用快速 diff 算法，LIS 算法。 diff 算法的展开请看图解 diff
